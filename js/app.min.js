(()=>{"use strict";window.addEventListener("load",(function(){const t=document.querySelector("#game"),e=new class{img;x;src="img/icons/heart.svg";block;blockSize=32;maxPosXSprite=4;generateHearts(e,s){this.block=document.createElement("div"),this.block.classList.add("active"),this.block.id="heart",this.block.style.cssText=`\n                width: ${this.blockSize}px;\n                height: ${this.blockSize}px;\n                position: absolute;\n                overflow: hidden;\n                top: ${32*s}px;\n                left: ${32*e}px;\n            `,this.img=document.createElement("img"),this.img.src=this.src,this.img.style.cssText=`\n                width: ${this.blockSize*this.maxPosXSprite}px;\n                height: ${this.block}px;\n                position: absolute;\n                top: 0px;\n                left: 0px;\n            `,t.appendChild(this.block),this.block.appendChild(this.img)}};function s(){const t=document.querySelectorAll("#heart.active");if(t.length){const e=t[t.length-1];e.classList.remove("active");const s=e.querySelector("img");let i=0;const h=setInterval((()=>{i<=3?(s.style.left=32*-i+"px",i++):clearInterval(h)}),100)}}const i=document.querySelector("#hero"),h=document.querySelector("#mainHeroes");let l=5,a=8,o=0,n=0;const r=96;let c,p,m="stand",f="right",u=!0,d=Math.ceil(Number.parseInt(getComputedStyle(i).left)/32),g=Math.ceil(Number.parseInt(getComputedStyle(i).bottom)/32),x=!1,y=!1,S=!1,b=[],k=[],X=document.createElement("div");function v(t){clearInterval(c),clearInterval(p),c=null,p=null,u=!0,m=t}function P(){X.style.left=Number.parseInt(X.style.left)-a+"px",b.map((t=>{t[0]=t[0]-1/(32/a)})),k.map((t=>{t.moveRight()}))}function A(){X.style.left=Number.parseInt(X.style.left)+a+"px",b.map((t=>{t[0]=t[0]+1/(32/a)})),k.map((t=>{t.moveLeft()}))}function I(t,e=1){const s=document.createElement("img");s.src="img/tiles/main.jpg",s.style.cssText=`\n            position: absolute;\n            left: ${32*t}px;\n            bottom: ${32*e}px;\n            width: 32px;\n            height: 32px;\n        `,X.appendChild(s),b.push([t,e])}function T(t){I(t);const e=document.createElement("img");e.src="img/tiles/foundation.jpg",e.style.cssText=`\n            position: absolute;\n            left: ${32*t}px;\n            bottom: 0;\n            width: 32px;\n            height: 32px;\n        `,X.appendChild(e)}function M(t,e,s){for(let i=0;i<s;i++)I(t+i,e)}function w(){d=Math.ceil(Number.parseInt(getComputedStyle(i).left)/32),g=Math.ceil(Number.parseInt(getComputedStyle(i).bottom)/32)}function z(){w(),x=!0;for(let t=0;t<b.length;t++){if(Math.ceil(b[t][0])===d&&Math.ceil(b[t][1])+1===g){x=!1;break}if(Math.ceil(b[t][0])===d+2&&Math.ceil(b[t][1])+1===g){x=!1;break}}}function C(){if(w(),"right"===f){for(let t=0;t<b.length;t++)if(Math.ceil(b[t][0])===d+3&&Math.ceil(b[t][1])+1===g+1)return!1}else for(let t=0;t<b.length;t++)if(Math.ceil(b[t][0])===d-1&&Math.ceil(b[t][1])+1===g+1)return!1;return!0}X.style.cssText="\n        position: absolute;\n        left: 0px;\n        top: 0px;\n        width: 100%;\n        height: 100%;\n    ",t.appendChild(X),document.addEventListener("keydown",(t=>{const e=t.code;"KeyD"!==e&&"ArrowRight"!==e||y||"rightWalk"!=m&&"fall"!=m&&"hurt"!=m&&(v("rightWalk"),h.style.top="0px",h.style.transform="scale(1, 1)",f="right",c=setInterval((()=>{o<=-576?o=0:o-=r,h.style.left=o+"px"}),60),p=setInterval((()=>{C()&&(P(),z(),x&&v("fall"),y&&v("stand"))}),17)),"KeyA"!==e&&"ArrowLeft"!==e||S||"leftWalk"!=m&&"fall"!=m&&"hurt"!=m&&(v("leftWalk"),h.style.top="0px",h.style.transform="scale(-1, 1)",f="left",c=setInterval((()=>{o>=0?o=-576:o+=r,h.style.left=o+"px"}),60),p=setInterval((()=>{console.log(Number.parseInt(X.style.left)),C()&&!S&&Number.parseInt(X.style.left)<0&&(A(),z(),x&&v("fall"))}),17)),"KeyF"===e&&"jump"!=m&&"fall"!=m&&"hit"!=m&&"hurt"!=m&&(v("hit"),h.style.top="-288px","right"===f?(h.style.transform="scale(1, 1)",h.style.left="0px",o=0,c=setInterval((()=>{o<=-480?v("stand"):(o-=r,h.style.left=o+"px")}),150)):(h.style.transform="scale(-1, 1)",h.style.left="-96px",o=-96,c=setInterval((()=>{o<=-576?v("stand"):(o-=r,h.style.left=o+"px")}),150))),"KeyW"!==e&&"Space"!==e&&"ArrowUp"!==e||"jump"!=m&&"fall"!=m&&"hurt"!=m&&(v("jump"),function(){n=32*g;const t=n;h.style.top="-192px","right"===f?(h.style.left="0px",o=0,h.style.transform="scale(1, 1)"):(h.style.left="-672px",o=-672,h.style.transform="scale(-1, 1)"),p=setInterval((()=>{"right"===f?o<=-384?o=0:o-=r:o>=377?o=-672:o+=r,h.style.left=o+"px"}),63.75),c=setInterval((()=>{n+=a,function(){if(w(),"right"===f){for(let t=0;t<b.length;t++)if(Math.ceil(b[t][0])===d+1&&Math.ceil(b[t][1])+1===g+2)return!1}else for(let t=0;t<b.length;t++)if(Math.ceil(b[t][0])===d&&Math.ceil(b[t][1])+1===g+2)return!1;return!0}()||v("fall"),n-t>150&&(z(),v(x?"fall":"stand")),"right"===f?P():A(),i.style.bottom=n+"px"}),17)}())})),document.addEventListener("keyup",(t=>{"fall"!=m&&"jump"!=m&&"hit"!=m&&"hurt"!=m&&v("stand")}));class N{STAND="stand";ATTACK="attack";DEATH="death";WALK="walk";HURT="hurt";posX;posY;startX;travelInterval=6;direction=.1;img;block;blockSize=96;timer;animation;animationSome;state="stand";attack=!1;animateWasChanged=!0;isHurt=!1;SpriteMaxPosX=6;SpriteMaxPosY=5;SpritePosX=0;SpritePosY=0;NumPosStand=2;NumPosHurt=1;NumPosWalk=5;NumPosAttack=3;NUmPosDeath=4;lives=2;constructor(t,e){this.posX=t,this.posY=e,this.startX=this.posX,this.createEnimy(),k.push(this),this.lifeCycle(),this.changeAnimate(this.WALK),this.updatePositionX()}createEnimy(){this.block=document.createElement("div"),this.block.style.cssText=`\n                position: absolute;\n                left: ${32*this.posX}px;\n                bottom: ${32*this.posY}px;\n                width: ${this.blockSize}px;\n                height: ${this.blockSize}px;\n                overflow: hidden;\n            `,t.appendChild(this.block),this.img=document.createElement("img"),this.img.src="img/characters/enemies/StandDog.svg",this.img.style.cssText=`\n                position: absolute;\n                left: 0;\n                bottom: 0;\n                width: ${this.blockSize*this.SpriteMaxPosX}px;\n                height: ${this.blockSize*this.SpriteMaxPosY}px;\n            `,this.block.appendChild(this.img)}lifeCycle(){this.timer=setInterval((()=>{if(this.checkCollide(),this.animateWasChanged)switch(this.animateWasChanged=!1,this.state){case this.DEATH:this.deathAnimate();break;case this.HURT:this.hurtAnimate();break;case this.WALK:this.walkAnimate();break;case this.STAND:this.standAnimate();break;case this.ATTACK:this.attackAnimate();break;case this.DEATH:this.deathAnimate()}}),17)}updatePositionX(){setInterval((()=>{this.block.style.left=32*this.posX+"px"}))}checkCollide(){g==this.posY?d==Math.floor(this.posX)?(y=!0,S=!1,"hit"!==m||this.state==this.HURT||this.isHurt?this.attack||this.changeAnimate(this.ATTACK):(this.isHurt=!0,setTimeout((()=>{this.changeAnimate(this.HURT),this.showHurt(),this.lives--}),600))):d==Math.floor(this.posX+2)||d==Math.floor(this.posX+1)?(S=!0,y=!1,"hit"!==m||this.state==this.HURT||this.isHurt?this.attack||this.changeAnimate(this.ATTACK):(this.isHurt=!0,setTimeout((()=>{this.changeAnimate(this.HURT),this.showHurt(),this.lives--}),600))):this.state===this.ATTACK&&(this.changeAnimate(this.WALK),this.attack=!1,S=!1,y=!1):this.state===this.ATTACK&&(this.changeAnimate(this.WALK),this.attack=!1,S=!1,y=!1)}changeAnimate(t){clearInterval(this.animation),this.animation=null,clearInterval(this.animationSome),this.animationSome=null,this.state=t,this.animateWasChanged=!0}standAnimate(){this.img.style.top="0px",this.img.style.left="0px",this.SpritePosX=1,this.animation=setInterval((()=>{this.direction===Math.abs(this.direction)?(this.img.style.transform="scale(-1, 1)",-this.SpritePosX*this.blockSize>=-(this.SpriteMaxPosX-1-this.NumPosStand)*this.blockSize?this.SpritePosX=this.SpriteMaxPosX:(this.SpritePosX--,this.img.style.left=-this.SpritePosX*this.blockSize+"px")):(this.img.style.transform="scale(1, 1)",this.SpritePosX===this.NumPosStand?this.SpritePosX=0:this.SpritePosX++,this.img.style.left=-this.SpritePosX*this.blockSize+"px")}),100)}walkAnimate(){this.img.style.top=4*-this.blockSize+"px",this.img.style.left="0px",this.SpritePosX=1,this.animationSome=setInterval((()=>{this.posX>this.startX+this.travelInterval?(this.direction*=-1,this.img.style.transform="scale(1, 1)"):this.posX<=this.startX&&(this.direction=Math.abs(this.direction),this.img.style.transform="scale(-1, 1)"),this.posX+=this.direction,this.block.style.left=32*this.posX+"px"}),17),this.animation=setInterval((()=>{this.img.style.left=-this.SpritePosX*this.blockSize+"px",this.SpritePosX===this.NumPosWalk?this.SpritePosX=0:this.SpritePosX++}),100)}attackAnimate(){this.attack=!0,this.img.style.top=-2*this.blockSize+"px",this.img.style.left="0px",this.SpritePosX=0,this.animation=setInterval((()=>{this.direction===Math.abs(this.direction)?(this.img.style.transform="scale(-1, 1)",-this.SpritePosX*this.blockSize>=-(this.SpriteMaxPosX-1-this.NumPosAttack)*this.blockSize?(this.SpritePosX=this.SpriteMaxPosX,"jump"!=m&&"fall"!=m&&(v("hurt"),l--,s())):(this.SpritePosX--,this.img.style.left=-this.SpritePosX*this.blockSize+"px")):(this.img.style.transform="scale(1, 1)",this.SpritePosX>=this.NumPosAttack?(this.SpritePosX=0,"jump"!=m&&"fall"!=m&&(v("hurt"),l--,s())):(this.SpritePosX++,this.img.style.left=-this.SpritePosX*this.blockSize+"px"))}),150)}deathAnimate(){this.img.style.top=-1*this.blockSize+"px",this.direction===Math.abs(this.direction)?(this.img.style.transform="scale(-1, 1)",this.img.style.left=-(this.SpriteMaxPosX-this.NUmPosDeath*this.blockSize)+"px",this.posXSprite=this.SpriteMaxPosX+2-this.NUmPosDeath,this.animation=setInterval((()=>{this.posXSprite<2?clearInterval(this.animation):(this.img.style.left=-this.posXSprite*this.blockSize+"px",this.posXSprite--)}),100)):(this.img.style.transform="scale(1, 1)",this.img.style.left="0px",this.posXSprite=0,this.animation=setInterval((()=>{this.posXSprite>this.NUmPosDeath?clearInterval(this.animation):(this.img.style.left=-this.posXSprite*this.blockSize+"px",this.posXSprite++)}),100)),clearInterval(this.timer),S=!1,y=!1}hurtAnimate(){this.img.style.top=-3*this.blockSize+"px",this.direction===Math.abs(this.direction)?(this.img.style.transform="scale(-1, 1)",this.img.style.left=-(this.SpriteMaxPosX-this.NumPosHurt)*this.blockSize+"px"):(this.img.style.transform="scale(1, 1)",this.img.style.left=-this.NumPosHurt*this.blockSize+"px"),setTimeout((()=>{this.isHurt=!1,this.lives<=0?this.changeAnimate(this.DEATH):this.changeAnimate(this.ATTACK)}),300)}showHurt(){const e=document.createElement("p");e.innerText="-1",e.style.cssText=`\n                color: red;\n                font-weight: 700;\n                font-size: 30px;\n                text-shadow: 1px 1px 2px #000;\n                position: absolute;\n                animation: showHurt 1s ease;\n                left: ${Number.parseInt(this.block.style.left+50)}px;\n                bottom: ${Number.parseInt(this.block.style.bottom+32)}px;\n            `,t.appendChild(e),setTimeout((()=>{e.parentNode.removeChild(e)}),1e3)}moveRight(){this.startX-=1/(32/a),this.posX-=1/(32/a)}moveLeft(){this.startX+=1/(32/a),this.posX+=1/(32/a)}}!function(){setInterval((()=>{u&&(u=!1,"fall"===m?(h.style.top="-192px","right"===f?(o=-192,h.style.transform="scale(1, 1)"):(o=-288,h.style.transform="scale(-1, 1)"),c=setInterval((()=>{n-=a,i.style.bottom=n+"px",z(),x||(i.style.bottom=32*g+"px",v("stand"))}),17),h.style.left=o+"px"):"stand"===m?c=setInterval((()=>{"right"===f?(o<=-96?o=0:o-=r,h.style.transform="scale(1, 1)"):(o>=-480?o=-576:o+=r,h.style.transform="scale(-1, 1)"),h.style.top="-96px",h.style.left=o+"px"}),100):"hurt"===m&&(h.style.top="-384px",h.style.left="right"===f?"0px":"-576px",setTimeout((()=>{v("stand")}),100)))}),17);for(let t=0;t<100;t++)t>10&&t<20||T(t);M(10,6,15),M(20,10,15),M(30,14,15),M(34,2,5),new N(25,2),new N(24,11);for(let t=.5;t<l+.5;t++)e.generateHearts(t,.5)}()}))})();